<script>
    // Definir la URL base
    const baseURL = `https://github.com/${repoOwner}/${repoName}/blob/main/`;
    const baseURLcolab = `https://colab.research.google.com/github/${repoOwner}/${repoName}/blob/main/`;

    // URL para obtener la lista de colaboradores
    const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contributors`;

    // Obtener el contenedor donde se mostrarán los colaboradores
    const contributorsList = document.getElementById('contributors-list');

    // Función para obtener el perfil completo de un colaborador
    async function fetchContributorProfile(contributor) {
        try {
            const profileUrl = contributor.url; // URL del perfil del colaborador
            const response = await fetch(profileUrl);
            const profile = await response.json();
            return profile.name || contributor.login; // Devuelve el nombre real o el login si no hay nombre
        } catch (error) {
            console.error("Error fetching contributor profile:", error);
            return contributor.login; // Si hay error, devuelve el login
        }
    }

    // Función para obtener los colaboradores desde la API
    async function fetchContributors() {
        try {
            const response = await fetch(apiUrl);
            const contributors = await response.json();

            // Recorrer y agregar los colaboradores a la lista
            for (const contributor of contributors) {
                // Omitir el usuario 'actions-user'
                if (contributor.login === 'actions-user') continue;

                // Obtener el nombre real del colaborador
                const name = await fetchContributorProfile(contributor);

                // Crear el elemento de la lista
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <a href="${contributor.html_url}" target="_blank">
                        ${name}
                    </a> (${contributor.contributions} contribuciones)
                `;
                contributorsList.appendChild(listItem);
            }
        } catch (error) {
            console.error("Error fetching contributors:", error);
        }
    }

    // Llamar a la función para cargar los colaboradores
    fetchContributors();

    // URL para obtener los últimos commits
    const commitsApiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/commits`;

    // Obtener el contenedor donde se mostrarán los commits
    const commitsList = document.getElementById('commits-list');

    // Función para obtener los últimos commits desde la API
    async function fetchRecentCommits() {
        try {
            const response = await fetch(commitsApiUrl);
            const commits = await response.json();

            // Filtrar commits para omitir los del autor "GitHub Action"
            const filteredCommits = commits.filter(commit => commit.commit.author.name !== 'GitHub Action');

            // Mostrar solo los últimos 5 commits después de filtrar
            const recentCommits = filteredCommits.slice(0, 5);

            // Recorrer los commits y agregarlos a la lista
            recentCommits.forEach(commit => {
                const listItem = document.createElement('li');
                const commitMessage = commit.commit.message;
                const commitAuthor = commit.commit.author.name;
                const commitDate = new Date(commit.commit.author.date).toLocaleDateString();

                listItem.innerHTML = `
                    ${commitMessage}<br>
                    <small>
                        Autor: ${commitAuthor} | Fecha: ${commitDate} | 
                        <a href="${commit.html_url}" target="_blank">Ver cambios</a>
                    </small>
                `;
                commitsList.appendChild(listItem);
            });
        } catch (error) {
            console.error("Error fetching recent commits:", error);
        }
    }

    // Llamar a la función para cargar los últimos commits
    fetchRecentCommits();

    // Obtener todos los divs con la clase "item"
    const items = document.querySelectorAll('.item');

    // Recorrer cada item y agregar el enlace dinámico
    items.forEach(item => {
        const link = item.getAttribute('data-link'); // Obtener la parte específica de la URL
        const aTag = document.createElement('a'); // Crear el elemento <a>
        aTag.href = baseURL + link; // Combinar la URL base con la parte específica
        aTag.appendChild(item.cloneNode(true)); // Clonar el contenido del div dentro del enlace
        item.replaceWith(aTag); // Reemplazar el div con el nuevo <a>
    });

    // Obtener todos los divs con la clase "item"
    const itemscolab = document.querySelectorAll('.item-colab');

    // Recorrer cada item y agregar el enlace dinámico
    itemscolab.forEach(item => {
        const link = item.getAttribute('data-link'); // Obtener la parte específica de la URL
        const aTag = document.createElement('a'); // Crear el elemento <a>
        aTag.href = baseURLcolab + link; // Combinar la URL base con la parte específica
        aTag.appendChild(item.cloneNode(true)); // Clonar el contenido del div dentro del enlace
        item.replaceWith(aTag); // Reemplazar el div con el nuevo <a>
    });
</script>